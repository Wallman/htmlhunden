<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width initial-scale=1.0">
<title>HTMLHunden | En pragmatisk höghastighetsguide till webbutveckling, använd vid Uppsala Universitet</title>
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.no-icons.min.css">
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css">
<link rel="stylesheet" href="/dist/assets/stylesheets/main.css">
<link rel="stylesheet" href="/dist/assets/stylesheets/prism.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><!-- Feedback tab--><link rel="stylesheet" href="http://getbarometer.s3.amazonaws.com/assets/barometer/css/barometer.css">
<script src="http://getbarometer.s3.amazonaws.com/assets/barometer/javascripts/barometer.js"></script>
<script>BAROMETER.load('zFXKA2467y8YdpZaQK3gq');</script>
<script>
if(document.location.hostname.search("localhost") === -1 && document.location.origin !== "file://"){
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-45465391-1', 'htmlhunden.se');
ga('send', 'pageview');
}
</script>
<body id="paginated">
<div class="container"><div class="page-header"><h2><a href="#documentready"><div class="icon-link"></div>$(document).ready</a></h2></div><p>I vår första djupdykning in i jQuery pratade vi kort om att det är viktigt att vänta tills hela DOM:en är inladdad innan vi börjar exekvera vår jQuery-beroende kod. I det här kapitlet kollar vi närmare på hur just <code>.ready()</code>-funktionen fungerar. Detta kapitel hjälper dig att skapa en djupare förståelse för både jQuery såväl som JavaScript.</p><h3>När dokumentet är redo för manipulation</h3><p>Denna mystiska ovan nämnda metod vid namn <code>.ready()</code> är en metod vi använder för att kunna vänta med att exekvera jQuery-kod tills webbläsaren har hunnit ladda in ("ned") hela sidan. Låt oss först se till ett exempel och sen diskutera det:</p><div class="panel panel-default"><div class="panel-heading">Att säga åt jQuery att vänta tills DOM:en är inläst</div><div class="panel-body"><pre><code class="language-javascript">$(document).ready(function(){
  alert("Hello world from jQuery");
});</code></pre></div></div><p>Ovan exempel använder jQuery för att avvakta tills webbläsaren har laddat in hela sidan. Sedan använder vi helt vanlig JavaScript för att poppa up en alert-ruta med meddelandet "Hello world...". Låt oss dissekera ovan kod, rad för rad och del för del, för att faktiskt förstå vad det är som händer.</p><h4>$() är syntaktiskt socker för jQuery()</h4><p>Först ut är detta mystiska dollartecken. Förklaringen till vad detta <em>är</em>, är egentligen ganska enkel. Förklaringen till varför vi <em>använder</em> tecknet inte lika. Men låt oss först diskutera vad det är. <code>$</code>-tecknet är egentligen ingenting annat än <a href="http://sv.wikipedia.org/wiki/Syntaktiskt_socker">syntaktiskt socker</a>. Alltså ett annat sätt att skriva någonting. Detta någonting är jQuery's huvudmetod med samma namn, alltså <code>jQuery</code>. Så, när vi med andra ord säger <code class="language-javascript">$(document)</code> är det <em>exakt samma sak</em> som när vi säger <code class="language-javascript">jQuery(document)</code>. Det förstnämnda är helt enkelt bara ett kortare sätt att uttrycka det på för att vi som programmerare ska slippa skriva så mycket.</p><h4>Variabeln document är dokumentets rot</h4><p><code>document</code> är helt enkelt en <em>variabel</em>. Men notera här alltså att vi säger att document är en variabel, vi säger inte att det är ett keyword. Varför är det viktigt att tänka på? Jo, <code>var</code> är ett keyword, en <a href="http://en.wikipedia.org/wiki/Language_construct">language construct</a> som alltid finns i JavaScript oavsett vart vi kör språket. Variabeln window är däremot ett koncept som är uppfunnit sonika för browsers. Om vi kör en JavaScript-interpretator i en <a href="http://en.wikipedia.org/wiki/Bash_(Unix_shell)">terminal</a> (alltså inte en browser) så existerar inte variabeln <code>document</code>. I browsern däremot, för att överhuvudtaget kunna manipulera en webbsida, behöver vi något sätt att genom javascript komma åt noderna (elementen) i vårt HTML-dokument. Således är <code>document</code>, löst uttryckt, vår "entry-point" in till noderna i html-dokumentet. I variabeln <code>document</code> hittar vi elementet <code>&lt;html&gt;</code> och som barn till det elementet hittar vi förstås resten av noderna. För att sammanfatta så är alltså <code>document</code> den variabel som innehåller hela vårt html-dokument och således den variabel vi behöver interagera med för att manipulera vårt dokument.</p><h4>$(document) eller jQuery(document)</h4><p>Nu vet vi alltså att <code>$()</code> är en korthandssyntax, och således samma sak som att anropa <code>jQuery()</code>. Men vad gör då denna metod? Jo, metoden returnerar ett jQuery-objekt som innehåller det vi har skickat in till den. Vi kan alltså se det som att jQuery <em>dekorerar</em> det vi har skickat in med alla dessa fantastiska jQuery-metoder. Låt oss exemplifiera.</p><pre><code class="language-javascript">// Dekorerar alla länkar med jquery
// Sparar referensen i variabeln link
var link = $('a');</code></pre><p>Vi använder alltså denna "jquery-dekorerade version" av ett html-element för att anropa de fantastiska metoder jquery utökar våra element med. Låt oss exemplifiera.</p><pre><code class="language-javascript">// Fade:a ut alla länkar
$('a').fadeOut();
 
// Samma sak i två steg
var link = $('a');
link.fadeOut();</code></pre><p>Det kan snabbt bli virrigt gällande vilka variabler som är jquery-dekorerade och vilka som inte är det. <a href="http://en.wikipedia.org/wiki/Coding_conventions">Konventionen</a> brukar således vara döpa sina variabler med ett initial <code>$</code>-tecken. Som så:</p><pre><code class="language-javascript">// Konventionen är att döpa jquery variabler med ett intialt $-tecken
var $link = $('a');</code></pre><p>För att återgå till det här med <code class="language-javascript">$(document)</code>. Vad betyder det då alltså att skicka in dokumentet till jquerys dekorationsmetod? Jo att vi nu kan anropa alla de fantastiska metoderna jquery erbjuder på vår rotnod. Det vill säga hela dokumentet. Att dekorera dokumentet med jquery har egentligen exakt samma effekt som att dekorera ett enskilt element (t.ex. en länk).</p><h4>För att veta när dokumentet är redo använder vi .ready()</h4><p>Precis som rubriken säger så använder vi metoden för att helt enkelt veta när dokumentet (DOM:en) är färdigladdat. Tänk efter. Eftersom vi använder jQuery-metoden för att dekorera element i vårt dokument. Så är det viktigt att alla element är "konstruerade" innan vi försöker komma åt dem. Hur ska vi kunna hitta alla länkar om vi inte är säker på att webbläsaren har hunnit läsa in alla länkar?</p><p>Vi kan använda <a href="http://learn.jquery.com/using-jquery-core/document-ready/">.ready()</a>-metoden, men vi kan också använda <a href="http://api.jquery.com/load/">.load()</a>-metoden. Den första nöjer sig med att <a href="http://sv.wikipedia.org/wiki/Document_Object_Model">DOM</a>:en (vilket kan ses som dokumentets struktur) har laddat. Den senare väntar på att alla resurser såsom bilder o.s.v. har laddat.</p><h4>Funktionen skickad till ready körs när dokumentet är redo</h4><p>Så vad ska vi skicka som argument till denna funktion? Jo, en till funktion! Va? Vääänta nu. En funktion som tar en funktion som argument? Det låter ju helknäppt. Men det är faktiskt inte så knäppt. Faktum är att mycket kod vi skriver i JavaScript går ut på att just skicka funktioner till funktioner. För att kunna skapa <a href="http://en.wikipedia.org/wiki/Callback_(computer_programming)">"callbacks"</a>. Den funktion vi skickar till <code>.ready()</code>-funktionen kan ses som ett callback som körs när dokumentet har laddat.</p><p>Tänk dig.. vi anropar jquery ready-metoden, och säger "Hej, nu vill jag att du säger till mig när sidans DOM har laddat klart". Sedan skickar vi in en funktion till ready-metoden och då är det som att vi säger "..och när sidans DOM har laddat klart, då vill jag att du utför allt som står i den här andra funktionen". Inga konstigheter!</p><h4>Allt i ett svep</h4><p>Så, låt oss repetera den kod vi pratar om i helhet.</p><pre class="line-numbers"><code class="language-javascript">$(document).ready(function(){
  alert("Hello world from jQuery");
});</code></pre><p>Låt oss beskriva koden i ord, rad för rad.</p><ol><li>Skapa ett <code>jQuery</code>-objekt av innehållet i variabeln <code>document</code>. Anropa sedan funktionen <code>ready()</code> på det jquery-dekorerade dokumentet. Skicka en <em>anonym funktion</em> som argument.</li><li>Låt den anonyma funktionen innehålla en enda rad. Denna rad anropar JavaScript-funktionen <code>alert()</code>, med strängen "Hello world.." som argument, och kommer således att visa göra så att alert-ruta "poppar upp" med texten "Hello world..".</li><li>Stäng den anonyma funktionen med <code>}</code>. Stäng sedan funktionsanropet med <code>)</code>. Terminera raden med <code>;</code>.</li></ol><div class="chapter-pagination"><p class="text-muted">Det här kapitlet är en del av en den interaktiva och pragmatiska höghastighetsguiden till webbutveckling &mdash; <a href="http://htmlhunden.se">HTMLHunden</a>. Använd knapparna nedan för att läsa vidare eller navigera till innehållsförteckningen.</p><div class="visible-xs"><div class="text-center"><div class="btn-group"><a href="06-01-jquery-intro.html" class="btn btn-sm btn-default pagination-prev">Föregående</a><a href="/dist/toc.html" class="btn btn-sm btn-default pagination-prev">Innehållsförteckning</a><a href="06-03-jquery-jqueryobjects.html" class="btn btn-sm btn-default pagination-next">Nästa</a></div></div></div><div class="hidden-xs"><div class="text-center"><div class="btn-group"><a href="06-01-jquery-intro.html" class="btn btn-lg btn-default pagination-prev">Föregående</a><a href="/dist/toc.html" class="btn btn-lg btn-default pagination-prev">Innehållsförteckning</a><a href="06-03-jquery-jqueryobjects.html" class="btn btn-lg btn-default pagination-next">Nästa</a></div></div></div></div></div> <!-- container --><script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script><script src="/dist/assets/javascripts/prism.js"></script><script src="/dist/assets/javascripts/main.js"></script></body>